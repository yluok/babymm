<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>主页</title>
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
<link rel="stylesheet" href="plugins/layui/css/layui.css" media="all">
<link rel="stylesheet" href="style/admin.css" media="all">
</head>
<body>

	<div class="layui-fluid">
		<div class="layui-row layui-col-space15">

			<div class="layui-col-sm6 layui-col-md3">
				<div class="layui-card">
					<div class="layui-card-header">账户总额</div>
					<div class="layui-card-body layuiadmin-card-list">
						<p class="layuiadmin-big-font" id="totalAmount"></p>
						<p>
							本年新增 <span class="layuiadmin-span-color"
								id="totalAmountIncrByYear"><i
								class="layui-inline layui-icon layui-icon-face-smile-b"></i></span>
						</p>
					</div>
				</div>
			</div>
			<div class="layui-col-sm6 layui-col-md3">
				<div class="layui-card">
					<div class="layui-card-header">
						压岁钱 <span class="layui-badge layui-bg-cyan layuiadmin-badge">年</span>
					</div>
					<div class="layui-card-body layuiadmin-card-list">
						<p class="layuiadmin-big-font" id="luckMoneyByYear"></p>
						<p>
							历史收到 <span class="layuiadmin-span-color" id="totalLuckyMoney"><i
								class="layui-inline layui-icon layui-icon-face-smile-b"></i></span>
						</p>
					</div>
				</div>
			</div>
			<div class="layui-col-sm6 layui-col-md3">
				<div class="layui-card">
					<div class="layui-card-header">
						打理收入 <span class="layui-badge layui-bg-green layuiadmin-badge">年</span>
					</div>
					<div class="layui-card-body layuiadmin-card-list">

						<p class="layuiadmin-big-font" id="incomeByYear"></p>
						<p>
							打理总收入 <span class="layuiadmin-span-color" id="totalIncome">
								<i class="layui-inline layui-icon layui-icon-dollar"></i>
							</span>
						</p>
					</div>
				</div>
			</div>
			<div class="layui-col-sm6 layui-col-md3">
				<div class="layui-card">
					<div class="layui-card-header">
						支出 <span class="layui-badge layui-bg-orange layuiadmin-badge">年</span>
					</div>
					<div class="layui-card-body layuiadmin-card-list">

						<p class="layuiadmin-big-font" id="consumeByYear"></p>
						<p>
							总支出 <span class="layuiadmin-span-color" id="totalConsume"><i
								class="layui-inline layui-icon layui-icon-user"></i></span>
						</p>
					</div>
				</div>
			</div>


			<div class="layui-col-sm12">
				<div class="layui-card">
					<div class="layui-card-body">
						<div class="layui-row">
							<div class="layui-col-sm6">
								<!-- 填充图表 -->
								<!-- 	<div id="amountForEachAccount"></div> -->
								<div id="amountForEachAccount"
									style="width: 600px;height:320px;"></div>
							</div>
							<div class="layui-col-sm6">
								<div class="layuiadmin-card-list">
									<p class="layuiadmin-normal-font">账户总额</p>
									<span>今年新增率</span>
									<div class="layui-progress layui-progress-big"
										lay-showPercent="yes">
										<div class="layui-progress-bar" lay-percent="300%" id="AccountIncreRate"></div>
									</div>
								</div>
								<div class="layuiadmin-card-list">
									<p class="layuiadmin-normal-font">打理收入</p>
									<span>今年新增率</span>
									<div class="layui-progress layui-progress-big"
										lay-showPercent="yes">
										<div class="layui-progress-bar" lay-percent="200%" id="incomeIncreRate"></div>
									</div>
								</div>
								<div class="layuiadmin-card-list">
									<p class="layuiadmin-normal-font">账户支出</p>
									<span>今年新增率</span>
									<div class="layui-progress layui-progress-big"
										lay-showPercent="yes">
										<div class="layui-progress-bar" lay-percent="2500%" id="cosumeIncreRate"></div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

		</div>
	</div>

	<script src="plugins/layui/layui.js"></script>
	<script type="text/javascript" src="plugins/jQuery/jquery-2.2.3.min.js"></script>
	<script type="text/javascript" src="plugins/echarts.min.js"></script>
	<script>
		layui.config({
			base : 'static/' //静态资源所在路径
		}).extend({
			index : 'lib/index' //主入口模块
		}).use([ 'index' ]);
	</script>

	<!-- 获取第一列各种统计数据 -->
	<script type="text/javascript">

		$(function() {
			$.ajax({
				url : 'account/totalAccountLeft', //获取账户总额
				success : function(result) {				
					$("#totalAmount").text(result);
				}
			})
	
			$.ajax({
				url : 'account/totalAmountIncrByYear', //获取账户总额之本年新增
				success : function(result) {					
					$("#totalAmountIncrByYear").text(result);
				}
			})
			$.ajax({
				url : 'account/totalLuckyMoney', //获取本年度压岁钱总额
				success : function(result) {			
					$("#totalLuckyMoney").text(result);
				}
			})
			$.ajax({
				url : 'account/luckMoneyByYear', //获取历史压岁钱总额
				success : function(result) {
					$("#luckMoneyByYear").text(result);
				}
			})
	
			$.ajax({
				url : 'account/totalIncome', //获取历史打理收入
				success : function(result) {
					$("#totalIncome").text(result);
				}
			})
			$.ajax({
				url : 'account/incomeByYear', //获取本年度打理收入总额
				success : function(result) {
					$("#incomeByYear").text(result);
				}
			})
	
			$.ajax({
				url : 'account/totalConsume', //获取历史总支出
				success : function(result) {
					$("#totalConsume").text(result);
				}
			})
			$.ajax({
				url : 'account/consumeByYear', //获取本年度总支出
				success : function(result) {
					$("#consumeByYear").text(result);
				}
			})
		})
	</script>

	<!-- 	绘制账户总额分布饼图 -->
	<script type="text/javascript">
	
		var amountForEachAccount = echarts.init(document.getElementById("amountForEachAccount"));
		amountForEachAccount.setOption({
			title : {
				text : '账户金额分布',
				x : 'center'
			},
			tooltip : {
				trigger : 'item',
				formatter : "{a} <br/>{b} : {c} ({d}%)"
			},
			legend : {
				orient : 'vertical',
				left : 'left',
			},
			series : [
				{
					name : '账户名：金额，单位：元',
					type : 'pie',
					radius : '60%',
					center : [ '40%', '50%' ],
				}
			]
		});
	
		var resultList = [];
		var nameList = [];
		$.ajax({
			url : 'account/findAccountList?iscash=true&ishide=false',
			dataType : "json",
			success : function(data) {
				// 填入数据
				for (i = 0; i < data.length; i++) {
					resultList.push({
						'value' : data[i].cashAmount / 100.0,
						'name' : data[i].name
					});
					nameList.push(data[i].name);
				}
	
				amountForEachAccount.setOption({
					legend:{
						data:nameList,
					},
					series : [
						{
							data:resultList,
						}
					]
	
				})
			}
		})
	</script>
	
	<!-- 统计第二行百分比 -->
	<script type="text/javascript">
		$.ajax({
				url : 'account/amountIncreRate', //获取本年度账户总额新增率
				success : function(result) {
					$("#AccountIncreRate").attr("lay-percent",(result * 100).toFixed(2) + "%");
				}
			})
		$.ajax({
				url : 'account/incomeIncreRate', //获取本年度账户总额新增率
				success : function(result) {
					$("#incomeIncreRate").attr("lay-percent",(result * 100).toFixed(2) + "%");
				}
			})
		$.ajax({
				url : 'account/cosumeIncreRate', //获取本年度账户总额新增率
				success : function(result) {
					$("#cosumeIncreRate").attr("lay-percent",(result * 100).toFixed(2) + "%");
				}
			})
	</script>
</body>
</html>